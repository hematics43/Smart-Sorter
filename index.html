<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Sorter Pro++ with Inline History</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", Arial, sans-serif;
      background: #f4f7fb;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      background: #fff;
      width: 100%;
      max-width: 560px;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
      margin-bottom: 15px;
      color: #333;
    }
    label {
      font-size: 14px;
      font-weight: 600;
      color: #555;
      display: block;
      margin-bottom: 6px;
    }
    textarea {
      width: 100%;
      height: 120px;
      padding: 10px;
      font-size: 14px;
      border: 1px solid #ddd;
      border-radius: 8px;
      resize: vertical;
      margin-bottom: 15px;
    }
    select, button {
      width: 100%;
      padding: 12px;
      font-size: 15px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }
    .options label {
      font-size: 13px;
      font-weight: normal;
    }
    #toggleViewBtn {
      background: #4a90e2;
      color: white;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }
    #result {
      background: #f9fafc;
      padding: 12px;
      border: 1px solid #eee;
      border-radius: 8px;
      font-size: 14px;
      min-height: 40px;
      white-space: pre-wrap;
      margin-bottom: 10px;
      cursor: pointer;
      user-select: text;
    }
    #result.copied { background: #d4f8d4; transition: background 0.5s; }
    #count {
      font-size: 13px;
      color: #666;
      margin-bottom: 20px;
    }
    #clearBtn {
      background: #ff4d4f;
      color: white;
      border: none;
      font-weight: bold;
      cursor: pointer;
      margin-bottom: 20px;
    }
    #clearBtn:hover { background: #d9363e; }
    #historyBox {
      background: #fafafa;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 10px;
      max-height: 250px;
      overflow-y: auto;
      font-size: 14px;
    }
    .history-entry {
      padding: 8px;
      border-bottom: 1px solid #ddd;
    }
    .history-entry:last-child { border-bottom: none; }
    .history-time { font-size: 12px; color: #777; margin-bottom: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>‚ú® Smart Sorter Pro++</h2>
    
    <label for="input">Enter words or numbers:</label>
    <textarea id="input" placeholder="e.g. apple, banana, 42, 7"></textarea>

    <label for="order">Sort order:</label>
    <select id="order">
      <option value="auto" selected>Auto Detect (Live)</option>
      <option value="alphaAsc">Alphabetical (A ‚Üí Z)</option>
      <option value="alphaDesc">Alphabetical (Z ‚Üí A)</option>
      <option value="numAsc">Numeric (Small ‚Üí Large)</option>
      <option value="numDesc">Numeric (Large ‚Üí Small)</option>
      <option value="original">Original Order</option>
      <option value="reverse">Reverse Original</option>
      <option value="shuffle">Shuffle (Random)</option>
      <option value="lengthAsc">By Length (Short ‚Üí Long)</option>
      <option value="lengthDesc">By Length (Long ‚Üí Short)</option>
    </select>

    <div class="options">
      <label><input type="checkbox" id="unique"> Remove Duplicates</label>
      <label><input type="checkbox" id="uppercase"> UPPERCASE</label>
      <label><input type="checkbox" id="lowercase"> lowercase</label>
      <label><input type="checkbox" id="capitalize"> Capitalize</label>
      <label><input type="checkbox" id="reverseEach"> Reverse Each Word</label>
    </div>

    <button id="toggleViewBtn">Switch to List View</button>

    <label>Result (double-click to copy):</label>
    <div id="result">‚ö†Ô∏è Start typing above‚Ä¶</div>
    <div id="count"></div>

    <button id="clearBtn">üóëÔ∏è Clear Saved Data</button>

    <h3>üìú History</h3>
    <div id="historyBox"></div>
  </div>

  <script>
    const inputEl = document.getElementById("input");
    const orderEl = document.getElementById("order");
    const uniqueEl = document.getElementById("unique");
    const upperEl = document.getElementById("uppercase");
    const lowerEl = document.getElementById("lowercase");
    const capEl = document.getElementById("capitalize");
    const reverseEachEl = document.getElementById("reverseEach");
    const resultEl = document.getElementById("result");
    const countEl = document.getElementById("count");
    const clearBtn = document.getElementById("clearBtn");
    const toggleViewBtn = document.getElementById("toggleViewBtn");
    const historyBox = document.getElementById("historyBox");

    let viewMode = "inline";
    let history = JSON.parse(localStorage.getItem("smartSorterHistory")) || [];

    function capitalizeWord(word) {
      return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
    }

    function detectDataType(items) {
      let numbers = 0, words = 0;
      items.forEach(item => !isNaN(parseFloat(item)) ? numbers++ : words++);
      return numbers > words ? "numeric" : "text";
    }

    function sortItems() {
      let input = inputEl.value.trim();
      let order = orderEl.value;

      if (!input) {
        resultEl.textContent = "‚ö†Ô∏è Please enter some values.";
        countEl.textContent = "";
        saveState();
        return;
      }

      let items = input.split(/[\s,]+/).filter(Boolean);
      if (uniqueEl.checked) items = [...new Set(items)];

      if (order === "auto") order = detectDataType(items) === "numeric" ? "numAsc" : "alphaAsc";

      let sorted;
      switch(order) {
        case "alphaAsc": sorted = [...items].sort((a,b)=>a.localeCompare(b)); break;
        case "alphaDesc": sorted = [...items].sort((a,b)=>b.localeCompare(a)); break;
        case "numAsc": sorted = [...items].sort((a,b)=>parseFloat(a)-parseFloat(b)); break;
        case "numDesc": sorted = [...items].sort((a,b)=>parseFloat(b)-parseFloat(a)); break;
        case "reverse": sorted = [...items].reverse(); break;
        case "shuffle": sorted = [...items].sort(()=>Math.random()-0.5); break;
        case "lengthAsc": sorted = [...items].sort((a,b)=>a.length-b.length); break;
        case "lengthDesc": sorted = [...items].sort((a,b)=>b.length-a.length); break;
        default: sorted = items;
      }

      if (upperEl.checked) sorted = sorted.map(x=>x.toUpperCase());
      else if (lowerEl.checked) sorted = sorted.map(x=>x.toLowerCase());
      else if (capEl.checked) sorted = sorted.map(x=>capitalizeWord(x));
      if (reverseEachEl.checked) sorted = sorted.map(x=>x.split("").reverse().join(""));

      resultEl.textContent = viewMode==="list" ? sorted.join("\n") : sorted.join(", ");
      countEl.textContent = `Count: ${sorted.length}`;

      addToHistory(resultEl.textContent);
      saveState();
    }

    function addToHistory(text) {
      if (!text || text.startsWith("‚ö†Ô∏è")) return;
      const now = new Date();
      const entry = {
        time: now.toLocaleString(),
        text: text
      };
      history.unshift(entry);
      localStorage.setItem("smartSorterHistory", JSON.stringify(history));
      renderHistory();
    }

    function renderHistory() {
      historyBox.innerHTML = "";
      if (history.length === 0) {
        historyBox.innerHTML = "<p>No history yet.</p>";
        return;
      }
      history.forEach(entry => {
        const div = document.createElement("div");
        div.className = "history-entry";
        div.innerHTML = `<div class="history-time">${entry.time}</div><div>${entry.text.replace(/\n/g,"<br>")}</div>`;
        historyBox.appendChild(div);
      });
    }

    function saveState() {
      const state = {
        input: inputEl.value, order: orderEl.value,
        unique: uniqueEl.checked, uppercase: upperEl.checked,
        lowercase: lowerEl.checked, capitalize: capEl.checked,
        reverseEach: reverseEachEl.checked,
        viewMode
      };
      localStorage.setItem("smartSorterState", JSON.stringify(state));
    }

    function loadState() {
      const state = JSON.parse(localStorage.getItem("smartSorterState"));
      if (!state) return;
      inputEl.value = state.input || "";
      orderEl.value = state.order || "auto";
      uniqueEl.checked = state.unique || false;
      upperEl.checked = state.uppercase || false;
      lowerEl.checked = state.lowercase || false;
      capEl.checked = state.capitalize || false;
      reverseEachEl.checked = state.reverseEach || false;
      viewMode = state.viewMode || "inline";
      toggleViewBtn.textContent = viewMode==="list" ? "Switch to Inline View" : "Switch to List View";
      sortItems();
    }

    clearBtn.addEventListener("click", () => {
      localStorage.removeItem("smartSorterState");
      inputEl.value = "";
      orderEl.value = "auto";
      uniqueEl.checked = upperEl.checked = lowerEl.checked = capEl.checked = reverseEachEl.checked = false;
      viewMode="inline";
      toggleViewBtn.textContent = "Switch to List View";
      resultEl.textContent="‚ö†Ô∏è Start typing above‚Ä¶";
      countEl.textContent="";
    });

    toggleViewBtn.addEventListener("click", () => {
      viewMode = viewMode==="inline" ? "list" : "inline";
      toggleViewBtn.textContent = viewMode==="list" ? "Switch to Inline View" : "Switch to List View";
      sortItems();
    });

    resultEl.addEventListener("dblclick", () => {
      const text = resultEl.textContent.trim();
      if (text && !text.startsWith("‚ö†Ô∏è")) {
        navigator.clipboard.writeText(text).then(() => {
          resultEl.classList.add("copied");
          setTimeout(() => resultEl.classList.remove("copied"), 800);
        });
      }
    });

    [inputEl, orderEl, uniqueEl, upperEl, lowerEl, capEl, reverseEachEl].forEach(el=>{
      el.addEventListener("input", sortItems);
      el.addEventListener("change", sortItems);
    });

    window.addEventListener("load", () => {
      loadState();
      renderHistory();
    });
  </script>
</body>
</html>
